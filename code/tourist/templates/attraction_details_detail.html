{% if detail %}
<div class="row">
    <div class="col-1"></div>
    <div class="col-10">
        <div class="return_pre" style="margin-top: -80px; margin-left: -40px;">
            <h3 onclick="showInfo()" title="上一頁">
                <div class="return_1 chineseFonst"><i class="fa-regular fa-circle-left"></i><strong>&thinsp;返回</strong>
                </div>
                <div class="return_2 chineseFonst"><strong>返回上一頁</strong></div>
            </h3>
        </div>
    </div>
    <div class="col-1"></div>
</div>
<div class="row">
    <div class="col-1"></div>
    <div class="col-10 total_att chineseFonst">
        <!-- 景點名稱 -->
        <div class="detail_name">
            <div class="detail_name__header">
                <div class="detail_name__headerGrid">
                    <h2 class="chineseFonst" style="color: rgb(172, 78, 1)" id="attractions-detail-name"><strong>{{ detail.a_name }}</strong>
                    </h2>
                </div>
                <div class="detail_name__headerGrid icon_add">
                    {% if is_favorite %}
                    <div class="icon_name" id="submitfavorite{{detail.id}}"
                        onclick="addFavorite_attractions(this,{{detail.id}})">
                        <i class="fas fa-regular fa-heart" title="已收藏" style="color: rgb(202, 13, 13);"></i>
                    </div>
                    {% else %}
                    <div class="icon_name" id="submitfavorite{{detail.id}}"
                        onclick="addFavorite_attractions(this,{{detail.id}})">
                        <i class="fas fa-regular fa-heart" title="收藏" style="color: rgb(111, 110, 110);"></i>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- 星星數 -->
        <div class="rating" style="margin-bottom: 10px;">
            {% for i in "12345" %}
            {% if i|add:0 <= detail.rating %} <i class="fa-solid fa-star" style="color:rgb(226, 185, 2);"></i>
                {% else %}
                <i class="fa-solid fa-star" style="color:rgb(185, 184, 184);"></i>
                {% endif %}
                {% endfor %}
                <span id="selectedRating">{{detail.rating}} / 5 ({{ detail.rating_total }}) </span>
        </div>
        <!-- 圖片(ok) -->
        <div class="detail_img" style="margin-top: 10px;">
            <div class="detail_img__header">
                <div class="detail_img__headerGrid">
                    <img src="/static/images/attractions/{{detail.place_id}}_0.jpg" class="show_detail_img"
                        style="margin-top: 1px; width:100%;max-width: 100%;" alt="" onclick="showPhotoDetail()">
                </div>
                <div class="detail_img__headerGrid">
                    <div class="row">
                        <img src="/static/images/attractions/{% if picture_list.1 %}{{picture_list.1}}{% else %}{{picture_list.0}}{% endif %}"
                            class="show_detail_img" style=" width:100%;" alt="" onclick="showPhotoDetail()">
                        <div class="image-container">
                            <img src="/static/images/attractions/{% if picture_list.1 %}{{picture_list.2}}{% else %}{{picture_list.0}}{% endif %}"
                                class="show_detail_img" style="width: 100%;margin-top: 2px;" alt=""
                                onclick="showPhotoDetail()">
                            <a id="see_all_btn" class="see_all_btn chineseFonst" onclick="showPhotoDetail()">查看所有照片</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 768px(RWD呈現圖片) -->
        <div class="att_slide">

            <div class="w3-content w3-display-container">
                {% for picture in picture_list %}
                <div class="w3-display-container mytotalSlides">
                    <img src="../static/images/attractions/{{picture}}" style="width:100%" onclick="showPhotoDetail()">
                </div>
                {% endfor %}
                <button class="w3-button w3-display-left w3-black" onclick="plustotalDivs(-1)">&#10094;</button>
                <button class="w3-button w3-display-right w3-black" onclick="plustotalDivs(1)">&#10095;</button>
            </div>
        </div>
        <!-- 景點整體介紹(ok) -->
        <div class="detail_detail" style="margin-top: -20px;">
            <div class="row">
                <div class="col-7">
                    <div class="detail_detail__header">
                        <div class="detail_detail__headerGrid">
                            <!-- 景點介紹 -->
                            <h6 class="chineseFonst" style="font-size: 20px;">
                                <i class="fa-solid fa-book-open"></i>
                                關於
                            </h6>
                            <h6  class="chineseFonst"style="margin-left: 30px; margin-top: 10px; margin-right: 30px; color: rgb(3, 54, 87);">
                                {{ detail.detail }}
                            </h6>
                            <hr style=" border:1px solid #777777; max-width: 95%;">
                            <!-- 地址(點擊連動到google導航) -->
                            <h6 class="chineseFonst" style="margin-top: 20px; font-size: 20px;" id="attractions-detail-address">
                                <i class="fa-solid fa-location-dot" style="color: rgb(201, 1, 1);"></i>
                                地址：<a href="#" style="color: blue;">{{detail.address}}</a>
                            </h6>
                            <!-- 電話 -->
                            {% if detail.phone != "" %}<h6 class="chineseFonst" id="attractions-detail-phone"
                                style="margin-top: 20px;font-size: 20px;">
                                <i class="fa-solid fa-phone" style="color: rgb(9, 145, 2);"></i>
                                電話：<a href="#" style="color: blue;">{{detail.phone }}</a>
                            </h6>{% endif %}
                            <!-- 營業時間 -->
                            <h6 class="chineseFonst" style="margin-top: 20px;font-size: 20px;">
                                <i class="fa-solid fa-clock" style="color: rgb(2, 79, 161);"></i>
                                營業時間：<br>
                                <div style="margin-left: 25px; margin-top: 10px;">
                                    {% for opentime in opentime_list %}
                                    {{chinese_week}}
                                    禮拜{{opentime.week}}：{% for open in opentime.opening %}{{open}}{% endfor %}<br>
                                    {% endfor %}
                                </div>
                            </h6>
                            <!-- 建議停留時間 -->
                            <h6 class="chineseFonst" style="margin-top: 20px;font-size: 20px;">
                                <i class="fa-solid fa-person-walking-luggage" style="color: rgb(174, 65, 150);"></i>
                                建議停留時間：{{ detail.stay_time }} 分鐘
                            </h6>
                            <!-- 旺季月份 -->
                            <h6 class="chineseFonst" style="margin-top: 20px;font-size: 20px;">
                                <i class="fa-solid fa-calendar-days" style="color: rgb(168, 126, 0);"></i>
                                旺季月份：{%if detail.hot_month|length == 12%} 全年 {% else %} {{ detail.hot_month }} {% endif %}
                            </h6>
                            <!-- 人潮資訊 -->
                            <h6 class="chineseFonst" style="margin-top: 20px;font-size: 20px;">
                                <i class="fa-solid fa-person-circle-exclamation" style="color: rgb(67, 1, 159);"></i>
                                人潮資訊：
                                <!-- 星期 -->
                                <div class="week_number chineseFonst">
                                    <span class="tag-week" data-set="0">星期一</span>
                                    <span class="tag-week" data-set="1">星期二</span>
                                    <span class="tag-week" data-set="2">星期三</span>
                                    <span class="tag-week" data-set="3">星期四</span>
                                    <span class="tag-week" data-set="4">星期五</span>
                                    <span class="tag-week" data-set="5">星期六</span>
                                    <span class="tag-week" data-set="6">星期日</span>
                                </div>
                                <!-- 圖表 -->
                                <div>
                                    <canvas id="people_if_Chart"  height="200%;"></canvas>
                                </div>
                            </h6>
                        </div>
                    </div>
                </div>
                <!-- 使用者提問及回答(ok) -->
                <div class="col-5">
                    <div class="detail_detail__headerGrid">
                        <div class="question">
                            <div class="qa-section">
                                <h5 class="chineseFonst" style="font-size: 24px;">
                                    <i class="fa-solid fa-circle-question" style="color: gray;"></i>
                                    問題與解答
                                </h5>
                                <div style="margin-left:20px ;color: #707070;">
                                    <div class="row">
                                        {% for question in question_list %}
                                        {% if forloop.counter <= 2 %} <div class="comment">
                                            <div class="avatar">
                                                <img src="{{question.u.get_photo}}" alt="User Avatar">
                                            </div>
                                            <div class="comment-content">
                                                <h5 class="username chineseFonst">
                                                    {{question.u.username}}
                                                </h5>
                                                <p class="comment-text chineseFonst">
                                                    {{question.content}}
                                                    <br>
                                                    <span
                                                        style="color:gray;font-size: 12px; font-style: italic;">{{question.question_date}}
                                                        &emsp;
                                                    </span>
                                                </p>
                                            </div>
                                    </div>

                                    {% endif %}

                                    {%empty%}
                                    <div class="chineseFonst" id="emptyQuestion">尚未有人發問</div>
                                    {% endfor %}
                                    {% if question_list|length %}
                                    <div>
                                        <h6 class="see_more chineseFonst" id="see_more" onclick="showAllLoaderAndContent()">
                                            查看所有問題（{{question_list | length }}）
                                        </h6>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- 提問按鈕 -->
                        {% if request.user.is_authenticated %}
                        <div style="text-align: center;">
                            <h6 class="ask_qa chineseFonst" id="ask_qa" onclick="showLoaderAndContent()">
                                提出問題
                            </h6>
                        </div>
                        {% else %}
                        <a href="/login">
                            <div style="text-align: center;">
                                <h6 class="ask_qa chineseFonst" id="ask_qa">
                                    登入後即可提問
                                </h6>
                            </div>
                        </a>
                        {% endif %}
                    </div>
                </div>
                <!-- 鄰近景點 -->
                <div class="row" style="margin-left: 10px;">
                    <h5 class="chineseFonst" style="font-size: 24px; margin-top: 20px; margin-bottom: 20px;">
                        <i class="fa-solid fa-map"></i>
                        鄰近景點
                    </h5>
                    <div class="row">
                        {% for near in near_attractions %}
                        <div class=" detail_near__header" onclick="showInfo({{ near.id }})">
                            <div class="detail_near__headerGrid">
                                <img src="/static/images/attractions/{{near.place_id}}_0.jpg" class="show_detail_img"
                                    style="margin-top: 1px; width:100%;max-width: 100%; border: black solid;" alt="">
                            </div>
                            <div class="detail_near__headerGrid">
                                <h4 class="near_name chineseFonst" data-bottom-top="transform: translateY(-20px);opacity: 0"
                                    data-center="transform: translateY(0px);opacity: 1" data-a-Id="{{ near.id }}">
                                    {{near.a_name }}
                                </h4>
                                <!-- 星星數 -->
                                <div class="rating1 chineseFonst" data-bottom-top="transform: translateY(-20px);opacity: 0"
                                    data-center="transform: translateY(0px);opacity: 1;">
                                    {% for i in "12345" %}
                                    {% if i|add:0 <= near.rating %} <span class="rating-star"
                                        style="color:rgb(214, 166, 54);">
                                        &#9733;</span>
                                        {% else %}
                                        <span class="rating-star">&#9733;</span>
                                        {% endif %}
                                        {% endfor %}
                                </div>
                                <!-- 評分 -->
                                <h6 class="score_RWD chineseFonst" style="margin-top:5px;"
                                    data-bottom-top="transform: translateY(-20px);opacity: 0"
                                    data-center="transform: translateY(0px);opacity: 1">
                                    <span id="list-selectedRating">{{ near.rating }}</span> / 5
                                    ({{near.rating_total}}則評分)
                                </h6>
                                <!-- 總瀏覽人數 -->
                                <h6 class="look_people chineseFonst" style="color:#8b8a8a;"
                                    data-bottom-top="transform: translateY(-20px);opacity: 0"
                                    data-center="transform: translateY(0px);opacity: 1">
                                    <i class="fa-regular fa-eye"></i>&thinsp;<span>{{near.hit}}</span>
                                </h6>
                            </div>
                        </div>
                        <hr class="near_hr">
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 訊問問題點擊載入動畫loader(ok) -->
    <div class="ask_big" id="ask_big" style="display: none;">
        <div class="background-mask" id="background-mask">
            <div class="loader"></div>
        </div>
    </div>
    <!-- 詢問問題彈跳框框(ok) -->
    <div class="out_ask_qa" id="out_ask_qa">
        <div id="ask_qa_container" class="ask_qa_container">
            <form class="ask-content" id="ask-content" action="/comment/{{detail.id}}/" method="POST">
                <div class="ask_container" id="ask_container">
                    <h5 class="chineseFonst" style="font-size: 24px;">
                        提出問題
                    </h5>
                    <span style="font-size: 18px; font-style: italic;color: rgb(172, 78, 1)">
                        <strong>{{ detail.a_name }}</strong></span>
                    <span class="close" id="close" title="關閉">&times;</span>
                </div>
                <div class="ask_qa_con" style="padding: 20px;">
                    <div class="comment">
                        <div class="avatar">
                            <img src="{{request.user.get_photo}}" alt="User Avatar">
                        </div>
                        <div class="comment-content">
                            <h6 class="username">
                                {{request.user.username}}<br>
                                <span class="chineseFonst" style="color: gray; font-size: 12px; font-style: italic;">公開發佈 &ensp;</span>
                                <i class="icon fa-solid fa-circle-exclamation" id="myIcon"></i>
                                <div class="tooltip1 chineseFonst" id="myTooltip1">
                                    您的貼文會與個人資料名稱及相片一併公開顯示，出現在網站上的各個地方。貼文必須遵循TripFunChill政策的規定。</div>
                            </h6>
                        </div>
                    </div>
                    <div>
                        <textarea class="chineseFonst" name="user_ask" id="user_ask" cols="100%" rows="7"
                            style="resize:none; border-radius: 10px;max-width: 100%; "
                            placeholder="向使用者社群提出詢或尋求建議。"></textarea>
                    </div>
                </div>
                <div class="post_ask chineseFonst">
                    <span class="ask_btn_cancel" id="ask_btn_cancel">取消</span>
                    <span class="ask_btn_ok" id="ask_btn_ok" onclick="sendAsk({{detail.id}})">張貼<span>
                </div>
            </form>
        </div>
    </div>
    <!-- 查看所有問題點擊載入動畫loader(ok) -->
    <div class="all_ask_big" id="all_ask_big" style="display: none;">
        <div class="all_background-mask" id="all_background-mask">
            <div class="all_loader"></div>
        </div>
    </div>
    <!-- 查看所有問題(ok) -->
    <div class="all_ask_qa chineseFonst" id="all_ask_qa">
        <div id="all_ask_qa_container" class="all_ask_qa_container">
            <form class="all_ask-content" id="all_ask-content" action="">
                <div class="all_ask_container" id="all_ask_container">
                    <h3 class="chineseFonst" style="color: rgb(172, 78, 1)">
                        <strong>{{ detail.a_name }}</strong>
                    </h3>
                    <span class="chineseFonst" style="color:rgb(67, 65, 65);font-size: 14px; font-style: italic;">
                        {{detail.address}}</span>
                    <span class="all_close" id="all_close" title="關閉">&times;</span>
                </div>
                <hr style=" border:1px solid #777777; max-width: 100%;">
                {% for question in question_list %}
                <div class="all_ask_qa_con">
                    <div class="all_ask_qa_comment">
                        <div class="all_ask_qa_list">
                            <h5 class="chineseFonst">{{question.content}}</h5>
                            <div style="position: relative;">
                                <i class="fa-solid fa-ellipsis-vertical" style="cursor: pointer; font-size: 16px;"
                                    id="myIcon1"></i>
                                <!-- 檢舉按鈕 -->
                                <div class="tooltip2 chineseFonst" id="myTooltip2" onclick="showReportLoaderAndContent()">
                                    檢舉
                                </div>
                            </div>
                        </div>
                        <div style="font-size: 18px; margin-bottom: 20px;">
                            <!-- 點擊張貼評論數字+1 -->
                            <span style="cursor: pointer;"><i class="fa-regular fa-comment"
                                    style=" color: rgb(89, 198, 53);margin-right: 5px;"></i><span
                                    id="commentCountElement">{{question.get_answer|length }}</span>
                            </span>
                        </div>
                    </div>
                    <!-- 放user新增回覆的框框 -->
                    <div class="comment_new" id="comment_new">
                        {% for answer in question.get_answer %}
                        <div class="comment">
                            <div class="avatar chineseFonst">
                                <img src="{{answer.u.get_photo}}" alt="User Avatar">
                            </div>
                            <div class="comment-content">
                                <h6 class="username chineseFonst">
                                    {{answer.u.username}}<br>
                                    <span class="chineseFonst"
                                        style="color: gray; font-size: 12px; font-style: italic;">{{answer.answer_date}}
                                        &ensp;</span>
                                </h6>
                                <h6 class="chineseFonst" style="margin-bottom: 20px;">{{answer.content}}</h6>
                            </div>
                        </div>
                        {% endfor %}
                    </div>


                    <div id="comment_qa" style="display: none;">
                    </div>
                    {% if request.user.is_authenticated %}
                    <div class="comment chineseFonst">
                        <div class="avatar">
                            <img src="{{request.user.get_photo}}" alt="User Avatar">
                        </div>
                        <div class="comment-content chineseFonst">
                            <h6 class="username chineseFonst">
                                {{request.user.username}}<br>
                            </h6>
                        </div>
                    </div>
                    <div>
                        <div>
                            <textarea class="chineseFonst" name="answer_qa{{question.id}}" id="answer_qa" cols="100%" rows="5"
                                style="resize: none; border-radius: 10px; max-width: 90%; margin-left: 40px; padding: 10px;"
                                placeholder="回答問題"></textarea>
                        </div>
                        <div class="post_ask chineseFonst">
                            <span class="all_ask_btn_ok" id="all_ask_btn_ok"
                                onclick="sendAnswer({{question.id}})">張貼</span>
                        </div>
                    </div>
                    {% else %}
                    <a href="/login">
                        <div style="text-align: center;">
                            <h6 class="ask_qa chineseFonst" id="ask_qa">
                                登入後即可提問
                            </h6>
                        </div>
                    </a>
                    {% endif %}
                </div>
                <hr style=" border:1px solid #777777; max-width: 100%;">
                {% empty %}
                <div class="chineseFonst" id="emptyQuestion">
                    <h4>尚未有人發問</h4>
                </div>
                {% endfor %}
            </form>
        </div>
    </div>
    <!-- 分享彈跳框框(ok) -->
    <div class="share_an_att" id="share_an_att">
        <div id="share_an_att_container" class="share_an_att_container">
            <form class="share_an_att-content" id="share_an_att-content" action="">
                <div class="share_att_container" id="share_att_container">
                    <h5 class="chineseFonst" style="font-size: 22px;">分享到...</h5>
                    <i class="fa-solid fa-xmark" id="closeShare"></i>
                </div>
                <div class="share_att_con">
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; ">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-brands fa-facebook"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                分享到Facebook
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; ">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-brands fa-facebook-messenger"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                分享到Messenger
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; ">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-brands fa-instagram" style="margin: 0 2px 0 3px;"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                分享到Instagram
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; ">
                        <div class="" style="font-size: 34px;">
                            <i class="fa-solid fa-envelope" style="margin:0 2px 0 1px;"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                透過電子郵件分享
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; ">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-solid fa-qrcode" style="margin: 0 3px 0 3px;"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                QR 碼
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Share_Copytips()">
                        <div class="" style="font-size: 30px; padding-top: 5px;">
                            <i class="fa-solid fa-link"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                複製連結
                            </h6>
                        </div>
                    </div>
                    <div class="chineseFonst" id="share_tips">已將連結複製到剪貼簿。</div>
                </div>
            </form>
        </div>
    </div>
    <!-- 查看所有圖片彈跳框框（ok) -->
    <div class="photo_att" id="photo_att">
        <div id="photo_big_att_container" class="photo_big_att_container">
            <form class="photo_att-content" id="photo_att-content" action="">
                <div class="photo_att_container chineseFonst" id="photo_att_container">
                    <h5 class="chineseFonst" style="font-size: 24px;">關於<span style="color: rgb(172, 78, 1)">
                            {{detail.a_name}}</span>的所有照片&emsp;</h5>
                    <i class="fa-solid fa-xmark" id="closePhoto"></i>
                </div>
                <div class="row">
                    <div class="col-4 photo_book chineseFonst">
                        <h6 class="chineseFonst">相簿</h6>
                        <div class="detail_photo" style="margin-top: 10px;">
                            <div class="detail_photo__header">
                                <div class="detail_photo__headerGrid" id="detail_photo__headerGrid_all">
                                    <img src="/static/images/attractions/{{detail.place_id}}_0.jpg"
                                        class="show_detail_img" style="margin-top: 1px; width:100%; max-width: 100%;"
                                        alt="">
                                    <div class="photo-text chineseFonst">
                                        所有照片（{{picture_list|length}}）
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 右邊圖片框(切換) -->
                    <div class="col-8 photo_show_book">
                        <div class="show_all_detail_photo" id="show_all_detail_photo"
                            style="margin-top: 10px; height: 500px; overflow-y: scroll;">
                            <div class="show_detail_photo__header">
                                {% for picture in picture_list %}
                                <div class="choice_slide" data-set="{{forloop.counter}}">
                                    <div class="show_detail_photo__headerGrid">
                                        <img src="/static/images/attractions/{{picture}}" class="show_detail_img"
                                            id="show_detail_img" style="margin-top: 1px; width:100%; max-width: 100%;"
                                            alt="">
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <!-- 所有照片（幻燈片） -->
                        <div class="slide_this_photo" id="slide_this_photo" style="display: none; width: 100%;">
                            <div class="w3-content" style="max-width:800px;position:relative">
                                <div class="change_sigle_photo chineseFonst" id="change_sigle_photo">
                                    <i class="fa-regular fa-clone" style="margin-right:10px;"></i>照片集
                                </div>
                                <div class="illustrate_photo chineseFonst">
                                    <h6><strong class="chineseFonst">管理階層</strong></h6>
                                    <div style="position: absolute;bottom: 0;">
                                        <p>{{ detail.a_name }}</p>
                                    </div>
                                </div>
                                {% for picture in picture_list %}
                                <div class="mySlides chineseFonst">
                                    <div class="phototext">第{{forloop.counter}}頁&emsp;(共{{picture_list | length}}頁)
                                    </div>
                                    <img class="mySlide" src="/static/images/attractions/{{picture}}"
                                        style="width: 100%;">
                                </div>
                                {% endfor %}
                                <div style="text-align: center; font-size: 24px;">
                                    <a class="w3-btn-floating photo_btn_left" onclick="plusDivs(-1)">
                                        <i class="fa-solid fa-arrow-left"></i></a>
                                    <a class="w3-btn-floating photo_btn_right" onclick="plusDivs(1)">
                                        <i class="fa-solid fa-arrow-right"></i></a>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- 檢舉彈跳框框(ok) -->
    <div class="report_an_att" id="report_an_att">
        <div id="report_an_att_container" class="report_an_att_container">
            <form class="report_an_att-content" id="report_an_att-content" action="">
                <div class="report_att_container" id="report_att_container">
                    <h5 class="chineseFonst" style="font-size: 22px;">你要檢舉何種濫用行為？</h5>
                    <i class="fa-solid fa-xmark" id="closereport"></i>
                </div>
                <div class="report_att_con">
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Report_Copytips()">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-regular fa-circle-xmark" style="color: rgb(37, 152, 1);"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                離題
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Report_Copytips()">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-solid fa-ban" style="color: rgb(199, 3, 3);"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                此內容不適用
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Report_Copytips()">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-brands fa-adversal" style="color: rgb(3, 94, 199);"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                廣告或垃圾內容
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Report_Copytips()">
                        <div class="" style="font-size: 34px;">
                            <i class="fa-regular fa-face-angry" style="color: rgb(199, 127, 3);"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                仇恨、暴力或不當內容
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Report_Copytips()">
                        <div class="" style="font-size: 36px;">
                            <i class="fa-solid fa-circle-info" style="color: rgb(3, 72, 199);"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                資訊不正確
                            </h6>
                        </div>
                    </div>
                    <div class="comment" id="comment_share" style="top:0; cursor: pointer; padding: 0 20px 0 20px; "
                        onclick="Report_Copytips()">
                        <div class="" style="font-size: 30px; padding-top: 5px;">
                            <i class="fa-solid fa-hand" style="color: rgb(134, 3, 199);"></i>
                        </div>
                        <div class="comment-content">
                            <h6 class="username chineseFonst" style="padding: 10px;">
                                其他
                            </h6>
                        </div>
                    </div>
                    <div class="chineseFonst" id="report_tips">感謝您的舉報，我們將做進一步的審核！</div>
                </div>
            </form>
        </div>
    </div>
    <hr style="border:2px solid #777777">
    <!-- 其他資訊(ok) -->
    <div class="row">
        <div class="col-12 others1">
            <!-- 使用者總評論 -->
            <h5 class="chineseFonst" style="font-size: 24px;">
                <i class="fa-solid fa-file" style="color: rgb(214, 149, 28);"></i>
                其他資訊
            </h5>
            <!-- 使用者按讚、收藏、分享、觀看人數 -->
            <div style="padding:0 100px 0 100px;">
            <div class="User_more_add_fav">
                <div class="User__header">
                    <div class="User__headerGrid" style="border-right: black dashed;">
                        <div class=" row" style="text-align:center;">
                            <div class="total_score_star chineseFonst">
                                <h2>
                                    <strong><i class="fa-solid fa-crown"
                                            style="color: rgb(214, 166, 54);"></i>總評分</strong>
                                </h2>
                            </div>
                            <div class="total_score_star">
                                <p style="font-size:60px;">
                                    <strong>{{detail.rating}}</strong>
                                </p>
                            </div>
                            <div class="total_star">
                                {% for i in "12345" %}
                                {% if i|add:0 <= detail.rating %}<span class="fa fa-star checked"></span>
                                    {% else %}
                                    <span class="fa fa-star"></span>
                                    {% endif %}
                                    {% endfor %}
                            </div>
                            <p class="chineseFonst">
                                {{detail.rating_total}}則評分
                            </p>
                        </div>
                    </div>
                    <div class="User__headerGrid" style="border-right: black dashed;">
                        <div class=" row" style="text-align:center;">
                            <div class="total_score_star chineseFonst">
                                <h2>
                                    <strong class="chineseFonst">收藏人數</strong>
                                </h2>
                            </div>
                            <div class="total_score_star">
                                <p style="font-size:60px;">
                                    <strong><i class="fa-solid fa-heart" style="color:rgb(186, 51, 51);"></i></strong>
                                </p>
                            </div>
                            <div class="total_score_star">
                                <h2>
                                    <strong class="chineseFonst">{{detail.get_favorite_count}}</strong>
                                </h2>
                            </div>
                        </div>
                    </div>
                    <div class="User__headerGrid">
                        <div class=" row" style="text-align:center;">
                            <div class="total_score_star chineseFonst">
                                <h2>
                                    <strong class="chineseFonst">觀看人數</strong>
                                </h2>
                            </div>
                            <div class="total_score_star">
                                <p style="font-size:60px;">
                                    <strong><i class="fa-solid fa-eye" style="color: gray;"></i></strong>
                                </p>
                            </div>
                            <div class="total_score_star chineseFonst">
                                <h2>
                                    <strong class="chineseFonst">{{detail.hit}}</strong>
                                </h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        <!-- RWD(768px)會用到的大小 -->
        <div class="col-12 others2">
            <!-- 使用者總評論 -->
            <h5 class="chineseFonst" style="font-size: 24px;">
                <i class="fa-solid fa-file" style="color: rgb(214, 149, 28);"></i>
                其他資訊
            </h5>
            <div class="row">
                <div class="col-3">
                    <div class="User__headerGrid">
                        <div class=" row" style="text-align:center;">
                            <div class="total_score_star chineseFonst">
                                <h2>
                                    <strong><i class="fa-solid fa-crown"
                                            style="color: rgb(214, 166, 54);"></i>總評分</strong>
                                </h2>
                            </div>
                            <div class="total_score_star">
                                <p style="font-size:60px;">
                                    <strong>{{detail.rating}}</strong>
                                </p>
                            </div>
                            <div class="total_star">
                                {% for i in "12345" %}
                                {% if i|add:0 <= detail.rating %}<span class="fa fa-star checked"></span>
                                    {% else %}
                                    <span class="fa fa-star"></span>
                                    {% endif %}
                                    {% endfor %}
                            </div>
                            <p class="chineseFonst">
                                {{detail.rating_total}}則評論
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-9" style="text-align: center;">
                    <div style="background-color: rgb(228, 202, 171);">
                        <h2 class="chineseFonst">
                            <strong><i class="fa-solid fa-heart"
                                    style="color:rgb(186, 51, 51); margin-right: 10px;"></i></strong>
                            <span style="margin-right: 20px;">收藏人數</span>
                            <span>{{detail.get_favorite_count}}</span>
                        </h2>
                    </div>
                    <div style="background-color: rgb(228, 202, 171);">
                        <h2 class="chineseFonst">
                            <strong><i class="fa-solid fa-eye" style="color: gray; margin-right: 10px;"></i></strong>
                            <span style="margin-right: 20px;">觀看人數</span>
                            <span>{{detail.hit}}</span>
                        </h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr style="border:2px solid #777777">
    <!-- 評論 -->
    <div class="row chineseFonst">
        <h5 class="chineseFonst" style="font-size: 24px;">
            <i class="fa-solid fa-pen" style="color: gray;"></i>
            評論
        </h5>
        <div class="col-3 write_comment_btn">
            <div>
                <div>
                    {% if request.user.is_authenticated %}
                    <h5 class="comment_topic chineseFonst" id="write_comment" onclick="showCommentLoaderAndContent()">
                        <strong>發表評論</strong>
                    </h5>
                    {% else %}
                    <a href="/login" style="text-decoration:none;">
                        <h5 class="comment_topic chineseFonst" id="write_comment">
                            <strong>登入後發表評論</strong>
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-9" style="margin-bottom:30px;">
            {% for comment in comment_list %}
            <div class="comment" style="margin-bottom:20px;" id="userComment{{comment.id}}" >
                <div class="avatar">
                    <img src="{{comment.u.get_photo}}" alt="User Avatar">
                </div>
                <div class="comment-content userComment">
                    <div style="display: flex; justify-content: space-between; position: relative;">
                        <h6 class="username chineseFonst">
                            {{comment.u.username}}<br>
                            <span style="color:gray;font-size: 12px; font-style: italic;">{{comment.comment_date}}</span>
                        </h6>
                        {% if comment.u.id == request.user.id %}
                        <!-- 3個小點點(icon) -->
                        <i class="fa-solid fa-ellipsis-vertical" style="cursor: pointer;"
                            onclick="Del_comment(this)"></i>
                        <!-- 評論刪除顯示框框 -->
                        <div class="comment_delete-box chineseFonst" onclick="deleteComment({{comment.id}})">
                            刪除
                        </div>
                        {% endif %}
                    </div>
                    <p class="comment-text chineseFonst">
                        {{comment.content}}
                        <br>
                    </p>
                    <!-- 只有他有點讚功能 -->
                    <span style="margin-right: 20px;cursor: pointer;" id="likeButton">
                        {% if request.user.id in comment.get_user_favorite %}
                        <i class="fa-thumbs-up fa-solid" style=" color: rgb(0, 102, 255);"></i>
                        {% else %}
                        <i class="fa-regular fa-thumbs-up" style=" color: rgb(0, 102, 255);"></i>
                        {% endif %}
                        <span id="likeCount">{{comment.get_favorite_count}}</span></span>
                </div>
            </div>
            {% empty %}
            <div class="chineseFonst" style="display: flex; justify-content: center; margin-bottom: 20px; margin-bottom: 60px;">
                <h5 class="chineseFonst">目前尚無留言！</h5>
            </div>
            {% endfor %}
            <!-- 分頁  -->
            <div class="page-container" style="display: flex ; justify-content: center;">
                <nav aria-label="Page navigation"></nav>
            </div>
        </div>
    </div>
    <!-- 評論彈跳框框(ok) -->
    <form class="ask-content" id="ask-content" action="/comment/{{detail.id}}/" method="POST">
        <div class="out_share_comment" id="out_share_comment">
            <div id="share_comment_container" class="share_comment_container">
                <form class="share_comment-content" id="share_comment-content" action="">
                    <div class="comment_container" id="comment_container">
                        <h5 style="font-size: 24px;">
                            {{ detail.a_name }}
                        </h5>
                    </div>
                    <div class="share_comment_con" style="padding: 20px;">
                        <div class="comment">
                            <div class="avatar">
                                <img src="{{request.user.get_photo}}" alt="User Avatar">
                            </div>
                            <div class="comment-content">
                                <h6 class="username">
                                    {{request.user.username}}<br>
                                    <span style="color: gray; font-size: 14px; font-style: italic;">公開發佈
                                        &ensp;</span>
                                    <span class="show_com_info"><i class="comment_info fa-solid fa-circle-info"
                                            id="comment_info"></i></span>
                                    <div class="show_comment_info chineseFonst" id="show_comment_info">
                                        您的貼文會與個人資料名稱及相片一併公開顯示。您的貼文必須遵循政策的規定。</div>
                                </h6>
                            </div>
                        </div>
                        <div>
                            <textarea class="chineseFonst"  name="user_share_comment" id="user_share_comment" cols="100%" rows="5"
                                style="resize:none; border-radius: 10px;max-width: 100%;padding: 10px; "
                                placeholder="詳細說明你在這個地點的親身體驗。"></textarea>
                        </div>
                        <div class="image-container_ph">
                            <!-- 預覽圖片 -->
                            <div id="imagePreview"></div>
                        </div>
                    </div>
                    <div class="post_share_comment chineseFonst">
                        <span class="share_comment_btn_cancel" id="share_comment_btn_cancel">取消</span>
                        <span class="share_comment_btn_ok" id="share_comment_btn_ok"
                            onclick="sendComment({{detail.id}})">張貼</span>
                    </div>
                </form>
            </div>
        </div>
    </form>
    <!-- 上傳景點圖片彈跳框框(ok) -->
    <div class="out_update_att_ph" id="out_update_att_ph">
        <div id="update_att_ph_container" class="update_att_ph_container">
            <form class="update_att_ph-content" id="update_att_ph-content" action="">
                <div class="update_ph_container" id="update_ph_container">
                    <h5 class="class="chineseFonst"" style="font-size: 24px;">
                        {{ detail.a_name }}
                    </h5>
                </div>
                <div class="update_att_ph_con" style="padding: 20px;">
                    <div class="comment">
                        <div class="avatar">
                            <img src="{{user.get_photo}}" alt="User Avatar">
                        </div>
                        <div class="update_att_ph-content">
                            <h6 class="username class="chineseFonst"">
                                {{user.username}}<br>
                                <span class="class="chineseFonst"" style="color: gray; font-size: 14px; font-style: italic;">公開發佈 &ensp;</span>
                                <span class="show_update_info"><i class="comment_info fa-solid fa-circle-info"
                                        id="update_info"></i></span>
                                <div class="show_up_info class="chineseFonst"" id="show_up_info">
                                    您上傳的景點照片會經過管理員審核後一併公開顯示。您必須遵循政策的規定。</div>
                            </h6>
                        </div>
                    </div>
                    <!-- 上傳評論圖片 -->
                    <div style="padding: 100px; border: black dashed; background-color: #f9edd2;">
                        <form action="" method="post" enctype="multipart/form-data">
                            <div class="up_date_photo">
                                <label for="updateInput" class="update_ph class="chineseFonst"">
                                    <i class="fa-solid fa-camera-retro"
                                        style="margin-right: 5px; margin-top: 5px;"></i><span>新增相片</span>
                                </label>
                                <input type="file" id="updateInput" accept="image/*" style="display: none;" multiple
                                    onchange="update_previewphoto(event)">
                            </div>
                        </form>
                    </div>
                    <div class="update-container_ph">
                        <!-- 預覽圖片 -->
                        <div id="updatePreview"></div>
                    </div>
                </div>
                <div class="post_update_att_ph class="chineseFonst"">
                    <span class="update_att_ph_btn_cancel" id="update_att_ph_btn_cancel">取消</span>
                    <span class="update_att_ph_btn_ok" id="update_att_ph_btn_ok">張貼</span>
                </div>
            </form>
        </div>
    </div>
</div>
</div>
<script src="../static/js/slideshow.js"></script>
<script src="../static/js/sendcomment.js"></script>
<script src="../static/js/watchQuestions.js"></script>
<!-- 圖表會用到script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script>
    var username = "{{request.user.username}}";
    var userPhoto = "{{request.user.get_photo}}";
    // // 評論刪除三個小點點
     function Del_comment(icon) {
         var deleteBox = icon.nextElementSibling;
         deleteBox.style.display = (deleteBox.style.display === 'block') ? 'none' : 'block';
         //點擊其他地方刪除div消失（關閉）
         document.addEventListener('click', function (event) {
             if (!deleteBox.contains(event.target) && event.target !== icon) {
                 deleteBox.style.display = 'none';
             }
         });
     }
     function deleteComment(id){
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        if(confirm('確定要刪除留言嗎？')){
            $.ajax({
                headers: { "X-CSRFToken": csrftoken },
                url: '/comment/delete_comment/',
                type: 'POST',
                data: {
                    'comment_id':id,
                },
                success: function (data) {
                    alert("刪除"+data["response_data"])
                    if(data["response_data"] == "成功"){
                        document.getElementById("userComment"+id).remove();
                    }
                }
            });
        }
     }
    var slideIndextotal = 1;
    showtotalDivs(slideIndextotal);

    function plustotalDivs(n) {
        showtotalDivs(slideIndextotal += n);
    }

    function showtotalDivs(n) {
        var i;
        var x = document.getElementsByClassName("mytotalSlides");
        if (n > x.length) { slideIndextotal = 1 }
        if (n < 1) { slideIndextotal = x.length }
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        x[slideIndextotal - 1].style.display = "block";
    }

    // 上傳景點圖片公開顯示tips
    var update_info = document.getElementById("update_info");
    var show_up_info = document.getElementById("show_up_info");
    update_info.addEventListener("click", function () {
        if (show_up_info.style.display === "block") {
            show_up_info.style.display = "none";
        } else {
            show_up_info.style.display = "block";
        }
    });
    // 如果用戶點其他地方，關閉提示
    document.addEventListener("click", function (event) {
        if (event.target !== update_info && event.target !== show_up_info) {
            show_up_info.style.display = "none";
        }
    });

    // 新增照片（上傳景點圖片）
    function update_previewphoto(event) {
        const updatePreview = document.getElementById("updatePreview");
        updatePreview.innerHTML = "";

        const files = event.target.files;
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            if (file.type.startsWith("image/")) {
                const updateContainer = document.createElement("div");
                updateContainer.classList.add("update-container");
                // 刪除不要上傳的圖片(已經上傳但是不要)
                const update_closeButton = document.createElement("span");
                update_closeButton.innerHTML = "&times;";
                update_closeButton.classList.add("close-button");
                update_closeButton.onclick = function () {
                    updatePreview.removeChild(updateContainer);
                };

                const imgElement = document.createElement("img");
                imgElement.src = URL.createObjectURL(file);
                imgElement.classList.add("update-image");

                updateContainer.appendChild(update_closeButton);
                updateContainer.appendChild(imgElement);
                updatePreview.appendChild(updateContainer);
            }
        }
    }

    // 打開上傳景點圖片框框
    function showupdateLoaderAndContent() {
        var all_loader = document.getElementById("all_ask_big");
        var out_update_att_ph = document.getElementById("out_update_att_ph");
        all_loader.style.display = "block";
        setTimeout(function () {
            all_loader.style.display = "none";
            out_update_att_ph.style.display = "block";
        }, 500);
    }
    // 關閉上傳景點圖片方塊
    var update_att_photo = document.getElementById('update_att_photo');
    var update_att_ph_container = document.getElementById('update_att_ph_container');
    var out_update_att_ph = document.getElementById('out_update_att_ph');
    document.addEventListener("click", function (event) {
        if (event.target == out_update_att_ph) {
            out_update_att_ph.style.display = "none";
        }
    });
    var update_att_ph_btn_cancel = document.getElementById('update_att_ph_btn_cancel');
    update_att_ph_btn_cancel.addEventListener("click", function () {
        out_update_att_ph.style.display = "none";
    });

    // 打開評論框框
    function showCommentLoaderAndContent() {
        var all_loader = document.getElementById("all_ask_big");
        var out_share_comment = document.getElementById("out_share_comment");
        all_loader.style.display = "block";
        setTimeout(function () {
            all_loader.style.display = "none";
            out_share_comment.style.display = "block";
        }, 500);
    }
    // 關閉評論方塊
    var write_comment = document.getElementById('write_comment');
    var share_comment_container = document.getElementById('share_comment_container');
    var out_share_comment = document.getElementById('out_share_comment');
    document.addEventListener("click", function (event) {
        if (event.target == out_share_comment) {
            out_share_comment.style.display = "none";
        }
    });
    var share_comment_btn_cancel = document.getElementById('share_comment_btn_cancel');
    share_comment_btn_cancel.addEventListener("click", function () {
        out_share_comment.style.display = "none";
    });

    // 評論公開顯示tips
    var comment_info = document.getElementById("comment_info");
    var show_comment_info = document.getElementById("show_comment_info");
    comment_info.addEventListener("click", function () {
        if (show_comment_info.style.display === "block") {
            show_comment_info.style.display = "none";
        } else {
            show_comment_info.style.display = "block";
        }
    });
    // 如果用戶點其他地方，關閉提示
    document.addEventListener("click", function (event) {
        if (event.target !== comment_info && event.target !== show_comment_info) {
            show_comment_info.style.display = "none";
        }
    });

    // 新增照片（評論）
    function previewphoto(event) {
        const imagePreview = document.getElementById("imagePreview");
        imagePreview.innerHTML = "";

        const files = event.target.files;
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            if (file.type.startsWith("image/")) {
                const previewContainer = document.createElement("div");
                previewContainer.classList.add("preview-container");
                // 刪除不要上傳的圖片(已經上傳但是不要)
                const closeButton = document.createElement("span");
                closeButton.innerHTML = "&times;";
                closeButton.classList.add("close-button");
                closeButton.onclick = function () {
                    imagePreview.removeChild(previewContainer);
                };

                const imgElement = document.createElement("img");
                imgElement.src = URL.createObjectURL(file);
                imgElement.classList.add("preview-image");

                previewContainer.appendChild(closeButton);
                previewContainer.appendChild(imgElement);
                imagePreview.appendChild(previewContainer);
            }
        }
    }

    // 幻燈片(切換過來的)
    var slideIndex = 1;
    showDivs(slideIndex);

    function plusDivs(n) {
        showDivs(slideIndex += n);
    }

    function showDivs(n) {
        var i;
        var x = document.getElementsByClassName("mySlides");
        if (n > x.length) { slideIndex = 1 }
        if (n < 1) { slideIndex = x.length };
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        x[slideIndex - 1].style.display = "block";
    }

    var closePhoto = document.getElementById('closePhoto');
    closePhoto.addEventListener("click", function () {
        photo_att.style.display = "none";
    });

    // focus點擊的地方（所有與旅客）
    var detail_photo__headerGrid_all = document.getElementById("detail_photo__headerGrid_all");//所有
    detail_photo__headerGrid_all.addEventListener("click", function () {
        detail_photo__headerGrid_all.style.border = "1px solid black";
        detail_photo__headerGrid_user.style.border = "none";
    });
    {% comment %} var detail_photo__headerGrid_user = document.getElementById("detail_photo__headerGrid_user");//旅客
    detail_photo__headerGrid_user.addEventListener("click", function () {
        detail_photo__headerGrid_user.style.border = "1px solid black";
        detail_photo__headerGrid_all.style.border = "none";
    }); {% endcomment %}

    // 切換相片和幻燈片功能
    var detail_photo__headerGrid_all = document.getElementById("detail_photo__headerGrid_all");
    var choice_slide = document.getElementsByClassName("choice_slide");
    var change_sigle_photo = document.getElementById("change_sigle_photo");
    var slide_this_photo = document.getElementById("slide_this_photo");
    var show_all_detail_photo = document.getElementById("show_all_detail_photo");
    var choice_slide = document.getElementsByClassName("choice_slide");
    var isHidden = true;
    var isChange = true;

    // 幻燈片（各個照片點擊跳出）
    for (var i = 0; i < choice_slide.length; i++) {
        choice_slide[i].addEventListener("click", function () {
            slideIndex = parseInt(this.dataset.set);
            showDivs(this.dataset.set);

            if (isHidden) {
                show_all_detail_photo.style.display = "none";
                slide_this_photo.style.display = "block";
            }
        });
    }
    // 相片集按鈕切換
    change_sigle_photo.addEventListener("click", function () {
        if (isChange) {
            slide_this_photo.style.display = "none";
            show_all_detail_photo.style.display = "block";
        }
    });
    // 所有（點擊）跳到相片集 在幻燈片時
    detail_photo__headerGrid_all.addEventListener("click", function () {
        if (isChange) {
            slide_this_photo.style.display = "none";
            show_all_detail_photo.style.display = "block";
        }
    });

    // loader動作（查看所有圖片）
    function showPhotoDetail() {
        var all_loader = document.getElementById("all_ask_big");
        var photo_att = document.getElementById("photo_att");
        all_loader.style.display = "block";
        setTimeout(function () {
            all_loader.style.display = "none";
            photo_att.style.display = "block";
        }, 500);
    }

    // loader動作 打開詢問問題方塊
    function showLoaderAndContent() {
        var loader = document.getElementById("ask_big");
        var out_ask_qa = document.getElementById("out_ask_qa");
        loader.style.display = "block";
        setTimeout(function () {
            loader.style.display = "none";
            out_ask_qa.style.display = "block";
        }, 500);
    }

    // 關閉詢問問題方塊
    var ask_qa = document.getElementById('ask_qa');
    var ask_qa_container = document.getElementById('ask_qa_container');
    var out_ask_qa = document.getElementById('out_ask_qa');
    document.addEventListener("click", function (event) {
        if (event.target == out_ask_qa) {
            out_ask_qa.style.display = "none";
        }
    });
    var close = document.getElementById('close');
    close.addEventListener("click", function () {
        out_ask_qa.style.display = "none";
    });
    var ask_btn_cancel = document.getElementById('ask_btn_cancel');
    ask_btn_cancel.addEventListener("click", function () {
        out_ask_qa.style.display = "none";
    });

    // ask_tips提示點擊
    var icon = document.getElementById("myIcon");
    var tooltip = document.getElementById("myTooltip1");

    icon.addEventListener("click", function () {
        if (tooltip.style.display === "block") {
            tooltip.style.display = "none";
        } else {
            tooltip.style.display = "block";
        }
    });
    // 如果用戶點其他地方，關閉提示
    document.addEventListener("click", function (event) {
        if (event.target !== icon && event.target !== tooltip) {
            tooltip.style.display = "none";
        }
    });
    // loader動作（查看更多問題）打開查看更多問提問題方塊
    function showAllLoaderAndContent() {
        watchQuestions();
        var all_loader = document.getElementById("all_ask_big");
        var all_ask_qa = document.getElementById("all_ask_qa");
        all_loader.style.display = "block";
        setTimeout(function () {
            all_loader.style.display = "none";
            all_ask_qa.style.display = "block";
        }, 500);
    }

    // 關閉查看更多問提問題方塊
    var see_more = document.getElementById('see_more');
    var all_ask_qa_container = document.getElementById('all_ask_qa_container');
    var all_ask_qa = document.getElementById('all_ask_qa');

    document.addEventListener("click", function (event) {
        if (event.target == all_ask_qa) {
            all_ask_qa.style.display = "none";
        }
    });
    var all_close = document.getElementById('all_close');
    all_close.addEventListener("click", function () {
        all_ask_qa.style.display = "none";
    });

    // 打開分享方塊
    function showShareLoaderAndContent() {
        var all_loader = document.getElementById("all_ask_big");
        var share_an_att = document.getElementById("share_an_att");
        all_loader.style.display = "block";
        setTimeout(function () {
            all_loader.style.display = "none";
            share_an_att.style.display = "block";
        }, 500);
    }
    // 關閉分享方塊
    var share_icon = document.getElementById('share_icon');
    var share_an_att_container = document.getElementById('share_an_att_container');
    var share_an_att = document.getElementById('share_an_att');

    document.addEventListener("click", function (event) {
        if (event.target == share_an_att) {
            share_an_att.style.display = "none";
        }
    });
    var closeShare = document.getElementById('closeShare');
    closeShare.addEventListener("click", function () {
        share_an_att.style.display = "none";
    });

    // 已經copy提示
    function Share_Copytips() {
        var x = document.getElementById("share_tips");
        x.className = "copy";
        setTimeout(function () {
            x.className = x.className.replace("copy", "");
        }, 3000);
    }

    // 打開檢舉方塊
    function showReportLoaderAndContent() {
        var report_an_att = document.getElementById("report_an_att");
        report_an_att.style.display = "block";
    }
    // 關閉檢舉方塊
    var report_icon = document.getElementById('report_icon');
    var report_an_att_container = document.getElementById('report_an_att_container');
    var report_an_att = document.getElementById('report_an_att');

    document.addEventListener("click", function (event) {
        if (event.target == report_an_att) {
            report_an_att.style.display = "none";
        }
    });
    var closereport = document.getElementById('closereport');
    closereport.addEventListener("click", function () {
        report_an_att.style.display = "none";
    });

    // 已經檢舉提示
    function Report_Copytips() {
        var x = document.getElementById("report_tips");
        x.className = "report";
        setTimeout(function () {
            x.className = x.className.replace("report", "");
        }, 3000);
    }

   {% comment %} 星期點擊時有focus css(預設禮拜日) {% endcomment %}
    var tagWeeks = document.querySelectorAll('.tag-week');
    tagWeeks.forEach(function(tagWeek) {
      tagWeek.addEventListener('click', function() {
        tagWeeks.forEach(function(element) {
          element.classList.remove('focus');
        });
        this.classList.add('focus');
      });
    }); 
     //人潮分佈圖(有加時間,數量)
    var total_data = [];
    var data_crowdlist = [];
    var crowd = JSON.parse('{{crowd | safe}}')
    for (var i = 0; i < crowd.length; i++) {
        for (var j = 0; j < crowd[i].crowd.length; j++) {
            data_crowdlist.push({
                "Time": `2020–09–01 ${j}:00`,
                "Volume": crowd[i].crowd[j]
            });
        }
        total_data.push({
            "week": crowd[i].week,
            "crowd": data_crowdlist
        });
        data_crowdlist = [];
    }
    var tagWeek = document.getElementsByClassName("tag-week");
    var crowdCanvas = document.getElementById('people_if_Chart')
    var ctx = crowdCanvas.getContext('2d');
    var chart;
    for (var i = 0; i < tagWeek.length; i++) {
        tagWeek[i].addEventListener("click", function () {
            if (chart) {
                chart.destroy();
            }
            var data = total_data[this.dataset.set].crowd;
            if (data.map(x => x.Volume).reduce((a, b) => a + b) == 0) { //判斷加總是否為0
                ctx.clearRect(0, 0, crowdCanvas.width, crowdCanvas.height);
                ctx.font = "72px Arial";
                ctx.fillStyle = "black";
                ctx.fillText("休息", 200, 200);
            } else {
                chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: data.map(x => x.Time.slice(11, 16)),
                        datasets: [{
                            // label: '人潮流量',
                            data: data.map(x => x.Volume),
                            // Line
                            lineTension: 0,
                            backgroundColor: '#FF5376',
                            borderColor: '#FF5376',
                            fill: false,
                            borderWidth: 2,
                            // Point
                            pointRadius: 5,
                            pointHoverRadius: 7,
                        }]
                    },
                    options: {
                        responsive: true,//可以隨RWD變動
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true, // 从0开始
                                    max: 100, // 最大值设置为100
                                }
                            }]
                        },
                        title: {
                            display: true,
                            // text: '人潮流量',
                            position: 'bottom',
                            fontSize: 24,
                            fontStyle: 'normal',
                            fontFamily: 'Century Gothic'
                        },
                        legend: {
                            display: false
                        },
                        
                        interaction: {
                            mode: 'point' // 设置交互模式为'point'以禁用点击和悬停
                        },
                        elements: {
                            line: {
                                tension: 0, // 设置线条的曲线张力为0，使线条更直接
                            }
                        },
                    }
                });
            }

        });
    }
    var currentDate = new Date();
    var currentWeek = (currentDate.getDay() + 6) % 7;
    tagWeek[currentWeek].click(); //今天
    // 判斷提出問題時，textarea有沒有東西
    var user_ask = document.querySelector("#user_ask");
    var ask_btn_ok = document.querySelector("#ask_btn_ok");

    user_ask.addEventListener("input", function () {
        if (user_ask.value.trim() === "") {
            ask_btn_ok.style.color = "grey";
            ask_btn_ok.style.border = "none";
            ask_btn_ok.style.pointerEvents = "none"; // 禁用點擊事件
        } else {
            ask_btn_ok.style.color = "black";
            ask_btn_ok.style.border = "#000 solid";
            ask_btn_ok.style.pointerEvents = "auto"; // 啟用點擊事件
        }
    });
</script>
{% endif %}